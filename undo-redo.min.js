//JS Undo-Redo v0.5
function undoRedo(e,t){function o(){var s={l:1};var o=JSON.stringify(t);if(i&&JSON.stringify(i)==o)return;if(i){n.push(i);if(n.length>e)n.shift();s.u=1}if(r.length>0){r.length=0;s.r=1}i=JSON.parse(o);c(s)}function u(){o();if(n.length>0){r.push(i);i=n.pop();l(t,i);c()}}function a(){o();if(r.length>0){n.push(i);i=r.pop();l(t,i);c()}}function f(){localStorage.clear();i=false;n.length=0;r.length=0}function l(e,t){e=e||{};if(e.length+""!="undefined"){while(e.length>0){e.pop()}}for(var n in t){if(typeof t[n]==="object"){e[n]=l(e[n],t[n])}else{e[n]=t[n]}}return e}function c(e){e=e||{u:1,l:1,r:1};if(e.u)s.stUndo=JSON.stringify(n);if(e.r)s.stRedo=JSON.stringify(r);if(e.l)s.lastSav=JSON.stringify(i)}var e=e||10;var n=[];var r=[];var i;var s=localStorage;if(s.lastSav){i=JSON.parse(s.lastSav);l(t,i);if(s.stUndo)n=JSON.parse(s.stUndo);if(s.stRedo)r=JSON.parse(s.stRedo)}return{save:o,undo:u,redo:a,clear:f,hasUndo:function(){return n.length>0},hasRedo:function(){return r.length>0}}}